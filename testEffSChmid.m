% ga=[0.85076709126941807, 0.26491783555872112, 0.45388753763003459;
%     -0.41837412595568318, 0.86408183906022318, 0.27986722948055326;
%     -0.31805415756407246, -0.42799663060494403, 0.84596716073794687];
% gb=[0.62242793968304100, 0.028017901264926870, -0.78217546440081687;
%     -0.56559231200968207, 0.70688489878968219, -0.42475766792212610;
%     0.54100720558738125, 0.70677346941704700, 0.45583162070080585];
% ga=[0.62242793968304100, 0.028017901264926870, -0.78217546440081687;
%     -0.56559231200968207, 0.70688489878968219, -0.42475766792212610;
%     0.54100720558738125, 0.70677346941704700, 0.45583162070080585]
% gb=[0.62290314318620488, 0.021300828150685569, -0.78200891870159728;
%     -0.56776490341110197, 0.69999754265725889, -0.43318178023594334;
%     0.53817719076836434, 0.71382751067319761, 0.44812453218137654]
ga=[0.85076709126941807, 0.26491783555872112, 0.45388753763003459;
    -0.41837412595568318, 0.86408183906022318, 0.27986722948055326;
    -0.31805415756407246, -0.42799663060494403, 0.84596716073794687]
    
gb=[0.62242793968304100, 0.028017901264926870, -0.78217546440081687;
-0.56559231200968207, 0.70688489878968219, -0.42475766792212610;
0.54100720558738125, 0.70677346941704700, 0.45583162070080585]

o1=orientation.byMatrix(ga,CS{2})
o2=orientation.byMatrix(gb,CS{2})

% mori=inv(o1)*o2
% angle(Mtest,twin{1}.RMT.axis.symmetrise)/degree
Lg2=CS{2}(:)*o2;
g1g2tLt=(o1*Lg2')
M=CS{2}(:)*g1g2tLt
MM=M*twin{1}.RMT

angs=angle(MM,'noSymmetry')'/degree
tmp=find(angs<2)
angs(tmp)
[val,id]=min(angs)

[sym_ops_n1,sym_ops_n2]=ind2sub([length(CS{2}) length(CS{2})],12);
CS{2}(sym_ops_n1).matrix
CS{2}(sym_ops_n2).matrix
sym1=CS{2}(sym_ops_n1);
sym2=CS{2}(sym_ops_n2);


%Compute the effschmid 
aa=twin{1}.Rtw*sym1*o1
aa=aa.matrix
ab=twin{1}.Rtw*sym2*o2
ab=ab.matrix
sigmam=sigma.matrix;

sg13a=dot(aa(1,:),aa(3,:)*sigmam')
sg13b=dot(ab(1,:),ab(3,:)*sigmam')

Lg2=sym2*o2;
g1g2tLt=(o1*Lg2')
M=sym1*g1g2tLt;
MM=M*twin{1}.RMT;

angs=angle(MM,'noSymmetry')'/degree


